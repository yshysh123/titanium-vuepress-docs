(window.webpackJsonp=window.webpackJsonp||[]).push([[288],{257:function(e,t,o){"use strict";o.r(t);var n=o(14),i=Object(n.a)({},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"titanium-geolocation"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#titanium-geolocation","aria-hidden":"true"}},[e._v("#")]),e._v(" Titanium.Geolocation")]),e._v(" "),o("ProxySummary"),e._v(" "),o("h2",{attrs:{id:"overview"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#overview","aria-hidden":"true"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),o("p",[e._v("This module combines two sets of features:")]),e._v(" "),o("ul",[o("li",[o("p",[e._v("Location services. Determining the location of the device.")])]),e._v(" "),o("li",[o("p",[e._v("Geocoding and reverse geocoding. Converting geographic  coordinates into\naddresses, and converting addresses into geographic  coordinates.")])])]),e._v(" "),o("p",[e._v("Using location services can have a significant impact on a device's battery life,\nso it's important to use them in the most efficient manner possible. Power consumption\nis strongly influenced by the accuracy and frequency of location updates required by\nyour application.")]),e._v(" "),o("p",[e._v("The location services systems of the underlying platforms are very different, so there\nare significant implementation differences between the platforms.")]),e._v(" "),o("p",[e._v("The basic methods of requesting location information and receiving location updates\nare essentially the same on all platforms. However, the method of configuring the\naccuracy and frequency of location updates is different for each platform.")]),e._v(" "),o("h3",{attrs:{id:"getting-location-information"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#getting-location-information","aria-hidden":"true"}},[e._v("#")]),e._v(" Getting Location Information")]),e._v(" "),o("p",[e._v("There are two ways to get location information:")]),e._v(" "),o("ul",[o("li",[o("p",[e._v("Make a one-time request with "),o("type-link",{attrs:{type:"Titanium.Geolocation.getCurrentPosition"}},[e._v("getCurrentPosition")]),e._v(".")],1)]),e._v(" "),o("li",[o("p",[e._v("Register to receive location updates by adding an event listener for the\n"),o("type-link",{attrs:{type:"Titanium.Geolocation.location"}},[e._v("location")]),e._v(" event.")],1)])]),e._v(" "),o("p",[o("strong",[e._v("NOTE:")]),e._v(" Location services stay enabled for as long as a listener is registered for the\n"),o("code",[e._v("location")]),e._v(" event, so be sure to remove the event listener when you do not require\nlocation updates.")]),e._v(" "),o("h3",{attrs:{id:"configurating-location-updates-on-ios"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#configurating-location-updates-on-ios","aria-hidden":"true"}},[e._v("#")]),e._v(" Configurating Location Updates on iOS")]),e._v(" "),o("p",[e._v("In iOS, the accuracy (and power consumption) of location services is primarily\ndetermined by the "),o("type-link",{attrs:{type:"Titanium.Geolocation.accuracy"}},[e._v("accuracy")]),e._v(" setting. This can be set\nto one of the following values:")],1),e._v(" "),o("ul",[o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_BEST"}},[e._v("ACCURACY_BEST")]),e._v(" (highest accuracy and power consumption)")],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_BEST_FOR_NAVIGATION"}},[e._v("ACCURACY_BEST_FOR_NAVIGATION")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_HIGH"}},[e._v("ACCURACY_HIGH")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_NEAREST_TEN_METERS"}},[e._v("ACCURACY_NEAREST_TEN_METERS")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_HUNDRED_METERS"}},[e._v("ACCURACY_HUNDRED_METERS")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_KILOMETER"}},[e._v("ACCURACY_KILOMETER")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_LOW"}},[e._v("ACCURACY_LOW")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_THREE_KILOMETERS"}},[e._v("ACCURACY_THREE_KILOMETERS")]),e._v(" (lowest\naccuracy and power consumption).")],1)]),e._v(" "),o("p",[e._v("Based on the accuracy you choose, iOS uses its own logic to select location providers\nand filter location updates to provide location updates that meet your accuracy\nrequirements.")]),e._v(" "),o("p",[e._v("You can further limit power consumption on iOS by setting the\n"),o("type-link",{attrs:{type:"Titanium.Geolocation.distanceFilter"}},[e._v("distanceFilter")]),e._v(" property to eliminate position\nupdates when the user is not moving.")],1),e._v(" "),o("p",[e._v("In order to receive the user's location, add either the\n"),o("a",{attrs:{href:"https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW26",target:"_blank",rel:"noopener noreferrer"}},[o("code",[e._v("NSLocationWhenInUseUsageDescription")]),o("OutboundLink")],1),e._v("\nor\n"),o("a",{attrs:{href:"https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW26",target:"_blank",rel:"noopener noreferrer"}},[o("code",[e._v("NSLocationAlwaysUsageDescription")]),o("OutboundLink")],1),e._v("\nkey to the iOS plist section of the project's "),o("code",[e._v("tiapp.xml")]),e._v(" file.")]),e._v(" "),o("pre",[o("code",[e._v("<ti:app>\n    <ios>\n        <plist>\n            <dict>\n                <key>NSLocationAlwaysUsageDescription</key>\n                <string>\n                    Specify the reason for accessing the user's location information.\n                    This appears in the alert dialog when asking the user for permission to\n                    access their location.\n                </string>\n            </dict>\n        </plist>\n    </ios>\n</ti:app>\n")])]),e._v(" "),o("p",[e._v("For iOS 11 and later, also add the "),o("a",{attrs:{href:"https://developer.apple.com/documentation/corelocation/choosing_the_authorization_level_for_location_services/request_always_authorization",target:"_blank",rel:"noopener noreferrer"}},[o("code",[e._v("NSLocationAlwaysAndWhenInUseUsageDescription")]),o("OutboundLink")],1),e._v('\nwhen planning to request the "Always" permission. Using the above key, you are also able to upgrade your permissions from\n"When in Use" to "Always", which is the recommended way for managing location permissions in iOS 11 and later.\nPlease also remember to request your desired location-permissions before using any geolocation-related API in\norder to receive the best usability and permission-control during the app-lifecycle using '),o("type-link",{attrs:{type:"Titanium.Geolocation.hasLocationPermissions"}},[e._v("Titanium.Geolocation.hasLocationPermissions")]),e._v("\nand "),o("type-link",{attrs:{type:"Titanium.Geolocation.requestLocationPermissions"}},[e._v("Titanium.Geolocation.requestLocationPermissions")]),e._v(". Also note that you also need to include the "),o("code",[e._v("NSLocationWhenInUseUsageDescription")]),e._v(" key\nin "),o("em",[e._v("any")]),e._v(" case when targeting iOS 11 and later. Descriptive error-logs will be thrown if required permissions are missing.")],1),e._v(" "),o("h3",{attrs:{id:"configurating-location-updates-on-android"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#configurating-location-updates-on-android","aria-hidden":"true"}},[e._v("#")]),e._v(" Configurating Location Updates on Android")]),e._v(" "),o("p",[e._v("On Android, three different location service modes are supported: "),o("em",[e._v("simple")]),e._v(", "),o("em",[e._v("manual")]),e._v(", and "),o("em",[e._v("legacy")]),e._v(".")]),e._v(" "),o("ul",[o("li",[o("p",[o("em",[e._v("Simple mode")]),e._v(" provides a compromise mode that provides adaquate support for\nundemanding location applications without requiring developers to\nwrite a lot of Android-specific code. To use simple mode:")]),e._v(" "),o("ol",[o("li",[o("p",[e._v("Leave the "),o("type-link",{attrs:{type:"Titanium.Geolocation.Android.manualMode"}},[e._v("Titanium.Geolocation.Android.manualMode")]),e._v(" flag set to "),o("code",[e._v("false")]),e._v(" (the\ndefault value).")],1)]),e._v(" "),o("li",[o("p",[e._v("Set the "),o("type-link",{attrs:{type:"Titanium.Geolocation.accuracy"}},[e._v("accuracy")]),e._v(" property to\neither "),o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_HIGH"}},[e._v("ACCURACY_HIGH")]),e._v(" or\n"),o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_LOW"}},[e._v("ACCURACY_LOW")]),e._v(".")],1)])])]),e._v(" "),o("li",[o("p",[o("em",[e._v("Manual mode")]),e._v(" gives developers low-level control of location updates, including\nenabling individual location providers and filtering updates, for the best\ncombination of accuracy and battery life.")]),e._v(" "),o("p",[e._v("Manual mode is used when the "),o("type-link",{attrs:{type:"Titanium.Geolocation.Android.manualMode"}},[e._v("Titanium.Geolocation.Android.manualMode")]),e._v(" flag is set\nto "),o("code",[e._v("true")]),e._v(". In manual mode, the "),o("code",[e._v("accuracy")]),e._v(" property is not used, and all\nconfiguration is done through the "),o("type-link",{attrs:{type:"Titanium.Geolocation.Android"}},[e._v("Titanium.Geolocation.Android")]),e._v(" module.")],1)]),e._v(" "),o("li",[o("p",[o("em",[e._v("Legacy mode")]),e._v(" is the mode that existed prior to 2.0. Legacy mode is\nused when the "),o("code",[e._v("manualMode")]),e._v(" flag is "),o("code",[e._v("false")]),e._v(" and the "),o("code",[e._v("accuracy")]),e._v(" property is\nset to one of the iOS "),o("code",[e._v("ACCURACY")]),e._v(" constants:")]),e._v(" "),o("ul",[o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_BEST"}},[e._v("ACCURACY_BEST")]),e._v(" (highest accuracy and power consumption)")],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_NEAREST_TEN_METERS"}},[e._v("ACCURACY_NEAREST_TEN_METERS")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_HUNDRED_METERS"}},[e._v("ACCURACY_HUNDRED_METERS")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_KILOMETER"}},[e._v("ACCURACY_KILOMETER")])],1),e._v(" "),o("li",[o("type-link",{attrs:{type:"Titanium.Geolocation.ACCURACY_THREE_KILOMETERS"}},[e._v("ACCURACY_THREE_KILOMETERS")]),e._v(" (lowest\naccuracy and power consumption).")],1)]),e._v(" "),o("p",[e._v("This mode is deprecated and should not be used for new development.")]),e._v(" "),o("p",[e._v("In this mode, the specified "),o("code",[e._v("accuracy")]),e._v(" value determines the\n"),o("em",[e._v("minimum distance between location updates")]),e._v(". If "),o("code",[e._v("accuracy")]),e._v(" is set to\n"),o("code",[e._v("ACCURACY_BEST")]),e._v(", no distance filter is used on updates.")]),e._v(" "),o("p",[e._v("In legacy mode, only a single location provider (GPS, network, or passive) is\nenabled at a time. You can specify a the location provider using the\n"),o("type-link",{attrs:{type:"Titanium.Geolocation.preferredProvider"}},[e._v("preferredProvider")]),e._v(" property.")],1),e._v(" "),o("p",[e._v("You can also specifying a desired update frequency using the\n"),o("type-link",{attrs:{type:"Titanium.Geolocation.frequency"}},[e._v("frequency")]),e._v(" property. The "),o("code",[e._v("preferredProvider")]),e._v("\nand "),o("code",[e._v("frequency")]),e._v(" properties are not used in any other mode.")],1)])]),e._v(" "),o("p",[e._v("As of Titanium SDK 7.1.0 and later, including the "),o("a",{attrs:{href:"https://github.com/appcelerator-modules/ti.playservices",target:"_blank",rel:"noopener noreferrer"}},[o("code",[e._v("ti.playservices")]),o("OutboundLink")],1),e._v(" module will allow Google Play Services\nto be used by default to obtain location information. This means the provider passed into "),o("type-link",{attrs:{type:"Titanium.Geolocation.Android.createLocationProvider"}},[e._v("createLocationProvider")]),e._v("\nwill be ignored, as Google Play Services will select the best provider based on current device conditions.\nIf Google Play Services is not available it will fallback to previous behaviour of using Android location APIs.")],1),e._v(" "),o("p",[e._v("To retrieve location events:")]),e._v(" "),o("pre",[o("code",[e._v("var win = Ti.UI.createWindow({ backgroundColor: 'white' });\n\nTi.Geolocation.accuracy = Ti.Geolocation.ACCURACY_HIGH;\n\nfunction getLocation() {\n    Ti.Geolocation.addEventListener('location', function(e) {\n        alert(JSON.stringify(e, null, 2));\n    });\n}\n\nwin.addEventListener('open', function() {\n    if (Ti.Geolocation.hasLocationPermissions()) {\n        getLocation();\n     } else {\n        Ti.Geolocation.requestLocationPermissions(Ti.Geolocation.AUTHORIZATION_ALWAYS, function(e) {\n            if (e.success) {\n                getLocation();\n            } else {\n                alert('could not obtain location permissions');\n            }\n        });\n    }\n});\n\nwin.open();\n")])]),e._v(" "),o("h3",{attrs:{id:"using-the-compass"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#using-the-compass","aria-hidden":"true"}},[e._v("#")]),e._v(" Using the Compass")]),e._v(" "),o("p",[e._v("Both iOS and Android support a receiving heading updates from a hardware compass, if available.")]),e._v(" "),o("p",[e._v("Check the "),o("type-link",{attrs:{type:"Titanium.Geolocation.hasCompass"}},[e._v("hasCompass")]),e._v(" property to see if the current\ndevice supports a compass.")],1),e._v(" "),o("p",[e._v("To retrieve compass readings, you can either use\n"),o("type-link",{attrs:{type:"Titanium.Geolocation.getCurrentHeading"}},[e._v("getCurrentHeading")]),e._v(" as shown in the\nprevious example, or add a listener for the\n"),o("type-link",{attrs:{type:"Titanium.Geolocation.heading"}},[e._v("heading")]),e._v(" event, as shown below:")],1),e._v(" "),o("pre",[o("code",[e._v("function compassHandler (e) {\n  if (e.success) {\n    Ti.API.info('Heading: ' + e.heading.magneticHeading);\n  }\n}\nTi.Geolocation.addEventListener('heading', compassHandler);\n")])]),e._v(" "),o("p",[e._v("Note that Android did not include a "),o("code",[e._v("success")]),e._v(" property in the "),o("code",[e._v("heading")]),e._v(" event prior to SDK 7.5.0.\nHeading events are only generated on Android when heading data is available. So if\n"),o("code",[e._v("success")]),e._v(" is undefined on prior SDK versions, we assume that the event contains valid compass data.")]),e._v(" "),o("p",[e._v("To obtain true heading data for the compass (as opposed to magnetic heading data),\na current location fix is required. See the notes on\n"),o("type-link",{attrs:{type:"HeadingData.trueHeading"}},[e._v("trueHeading")]),e._v(" for more information.")],1),e._v(" "),o("p",[e._v("As with location updates, the application should unregister for heading updates\nwhen it is no longer being used, or when it goes into the background. Use\n"),o("code",[e._v("removeEventListener")]),e._v(" to stop heading updates:")]),e._v(" "),o("pre",[o("code",[e._v("Ti.Geolocation.removeEventListener('heading', compassHandler);\n")])]),e._v(" "),o("p",[e._v("Finally, note that neither the Android emulator nor the iOS simulator provide\ncompass support. Compass code must be tested on physical devices.")]),e._v(" "),o("h3",{attrs:{id:"geocoding-services"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#geocoding-services","aria-hidden":"true"}},[e._v("#")]),e._v(" Geocoding Services")]),e._v(" "),o("p",[e._v("The module provides two methods, "),o("type-link",{attrs:{type:"Titanium.Geolocation.forwardGeocoder"}},[e._v("forwardGeocoder")]),e._v(" and "),o("type-link",{attrs:{type:"Titanium.Geolocation.reverseGeocoder"}},[e._v("reverseGeocoder")]),e._v("\nto convert between geographic coordinates and addresses. These methods map to MapQuest Open Nominatim Search Service.")],1),e._v(" "),o("p",[e._v("While this API has the advantage that it has no daily usage limits, please note that the data backing this API is crowd sourced and might not return\nproper values for valid addresses and geographic coordinates.")]),e._v(" "),o("p",[e._v("If geocoding services are essential component of the application, developers are encouraged to use commercial geocoding providers.")]),e._v(" "),o("ApiDocs")],1)},[],!1,null,null,null);i.options.__file="geolocation.md";t.default=i.exports}}]);